@page "/"
@rendermode InteractiveServer
@layout LandingLayout
@inject NavigationManager Navigation

<PageTitle>CARTRIDGE - Your Gaming Universe</PageTitle>

<div class="landing-container">
    <!-- Hero Section -->
    <section class="hero-section">
        <div class="hero-content">
            <div class="title-wrapper">
                <h1 class="hero-title">
                    <span class="title-line">🎮 CARTRIDGE 🎮</span>
                    <span class="title-subtitle">YOUR GAMING UNIVERSE</span>
                </h1>
            </div>
            
            <p class="hero-description">
                ALL YOUR GAMES FROM EVERY PLATFORM<br/>
                IN ONE EPIC RETRO INTERFACE
            </p>

            <div class="cta-buttons">
                <button class="btn-retro btn-large" @onclick="NavigateToSignUp">
                    ► START YOUR ADVENTURE ◄
                </button>
                <button class="btn-retro btn-retro-secondary btn-large" @onclick="NavigateToSignIn">
                    ► SIGN IN ◄
                </button>
            </div>

            <div class="platform-badges">
                <div class="platform-badge-item">Steam</div>
                <div class="platform-badge-item">Epic</div>
                <div class="platform-badge-item">GOG</div>
                <div class="platform-badge-item">Ubisoft</div>
                <div class="platform-badge-item">Rockstar</div>
                <div class="platform-badge-item">Amazon</div>
            </div>
        </div>
    </section>

    <!-- Animated Demo Section -->
    <section class="demo-section">
        <h2 class="section-title">
            ◄◄◄ LIVE DEMO ►►►
        </h2>
        
        <div class="demo-stats">
            <div class="demo-stat-box pulse">
                <div class="stat-number">@animatedGameCount</div>
                <div class="stat-label">GAMES COLLECTED</div>
            </div>
            <div class="demo-stat-box pulse-delayed">
                <div class="stat-number">@animatedPlatforms</div>
                <div class="stat-label">PLATFORMS CONNECTED</div>
            </div>
            <div class="demo-stat-box pulse-more-delayed">
                <div class="stat-number">@animatedHours</div>
                <div class="stat-label">HOURS PLAYED</div>
            </div>
        </div>

        <div class="demo-games-grid">
            @foreach (var game in demoGames)
            {
                <div class="demo-game-card-real @(game.IsActive ? "active" : "")">
                    @if (!string.IsNullOrEmpty(game.CoverUrl))
                    {
                        <div class="demo-game-image-container">
                            <img src="@game.CoverUrl" 
                                 alt="@game.Title" 
                                 class="demo-game-image"
                                 loading="lazy"
                                 onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';" />
                            <div class="demo-game-placeholder" style="display: none;">
                                🎮
                            </div>
                        </div>
                    }
                    else
                    {
                        <div class="demo-game-placeholder">
                            🎮
                        </div>
                    }
                    <div class="demo-game-info">
                        <h4 class="demo-game-title-real">@game.Title</h4>
                        <span class="demo-platform-badge">@game.Platform</span>
                    </div>
                </div>
            }
        </div>
    </section>

    <!-- Features Section -->
    <section class="features-section">
        <h2 class="section-title">
            ◄ LEGENDARY FEATURES ►
        </h2>
        
        <div class="features-grid">
            <div class="feature-card">
                <div class="feature-icon">🌟</div>
                <h3 class="feature-title">UNIFIED LIBRARY</h3>
                <p class="feature-text">
                    SEE ALL YOUR GAMES FROM STEAM, EPIC, GOG, AND MORE IN ONE PLACE
                </p>
            </div>

            <div class="feature-card">
                <div class="feature-icon">📊</div>
                <h3 class="feature-title">TRACK STATS</h3>
                <p class="feature-text">
                    MONITOR YOUR PLAYTIME AND GAMING ACHIEVEMENTS ACROSS PLATFORMS
                </p>
            </div>

            <div class="feature-card">
                <div class="feature-icon">🎯</div>
                <h3 class="feature-title">MANUAL ADDING</h3>
                <p class="feature-text">
                    ADD GAMES MANUALLY WITH AUTOMATIC COVER ART AND METADATA
                </p>
            </div>

            <div class="feature-card">
                <div class="feature-icon"></div>
                <h3 class="feature-title">SECURE & PRIVATE</h3>
                <p class="feature-text">
                    YOUR DATA IS ENCRYPTED AND STORED SECURELY
                </p>
            </div>
        </div>
    </section>

    <!-- Call to Action -->
    <section class="final-cta">
        <h2 class="cta-title">READY TO START?</h2>
        <button class="btn-retro btn-xlarge" @onclick="NavigateToSignUp">
            ► CREATE YOUR ACCOUNT NOW ◄
        </button>
        <div style="margin-top: 40px; padding-top: 30px; border-top: 2px dashed var(--retro-border); display: flex; flex-wrap: wrap; gap: 15px; justify-content: center; align-items: center;">
            <a href="https://discord.com/users/720315386394050560" target="_blank" rel="noopener noreferrer" style="color: var(--retro-secondary); text-decoration: none; display: inline-flex; align-items: center; gap: 8px; border: 2px solid var(--retro-secondary); padding: 10px 20px; transition: all 0.2s; background: rgba(0, 0, 0, 0.3); font-size: 10px;">
                <svg height="18" width="18" viewBox="0 0 127.14 96.36" fill="currentColor" style="display: inline-block;">
                    <path d="M107.7,8.07A105.15,105.15,0,0,0,81.47,0a72.06,72.06,0,0,0-3.36,6.83A97.68,97.68,0,0,0,49,6.83,72.37,72.37,0,0,0,45.64,0,105.89,105.89,0,0,0,19.39,8.09C2.79,32.65-1.71,56.6.54,80.21h0A105.73,105.73,0,0,0,32.71,96.36,77.7,77.7,0,0,0,39.6,85.25a68.42,68.42,0,0,1-10.85-5.18c.91-.66,1.8-1.34,2.66-2a75.57,75.57,0,0,0,64.32,0c.87.71,1.76,1.39,2.66,2a68.68,68.68,0,0,1-10.87,5.19,77,77,0,0,0,6.89,11.1A105.25,105.25,0,0,0,126.6,80.22h0C129.24,52.84,122.09,29.11,107.7,8.07ZM42.45,65.69C36.18,65.69,31,60,31,53s5-12.74,11.43-12.74S54,46,53.89,53,48.84,65.69,42.45,65.69Zm42.24,0C78.41,65.69,73.25,60,73.25,53s5-12.74,11.44-12.74S96.23,46,96.12,53,91.08,65.69,84.69,65.69Z"/>
                </svg>
                CONTACT ON DISCORD
            </a>
            <a href="https://github.com/AmedeoV/Cartridge" target="_blank" rel="noopener noreferrer" style="color: var(--retro-accent); text-decoration: none; display: inline-flex; align-items: center; gap: 8px; border: 2px solid var(--retro-accent); padding: 10px 20px; transition: all 0.2s; background: rgba(0, 0, 0, 0.3); font-size: 10px;">
                <svg height="18" width="18" viewBox="0 0 16 16" fill="currentColor" style="display: inline-block;">
                    <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/>
                </svg>
                VIEW ON GITHUB • OPEN SOURCE
            </a>
        </div>
    </section>
</div>

@code {
    private int animatedGameCount;
    private int animatedPlatforms;
    private int animatedHours;
    private Timer? animationTimer;
    private Timer? carouselTimer;
    private int currentGameIndex;
    
    private class DemoGame
    {
        public string Icon { get; set; } = "";
        public string Title { get; set; } = "";
        public string Platform { get; set; } = "";
        public string CoverUrl { get; set; } = "";
        public bool IsActive { get; set; }
    }
    
    private List<DemoGame> demoGames = new();

    protected override void OnInitialized()
    {
        // Initialize demo games with real cover art
        demoGames = new List<DemoGame>
        {
            new DemoGame 
            { 
                Icon = "🎮", 
                Title = "CYBERPUNK 2077", 
                Platform = "STEAM",
                CoverUrl = "https://media.rawg.io/media/games/26d/26d4437715bee60138dab4a7c8c59c92.jpg",
                IsActive = true
            },
            new DemoGame 
            { 
                Icon = "⚔️", 
                Title = "THE WITCHER 3", 
                Platform = "GOG",
                CoverUrl = "https://media.rawg.io/media/games/618/618c2031a07bbff6b4f611f10b6bcdbc.jpg"
            },
            new DemoGame 
            { 
                Icon = "🗡️", 
                Title = "ELDEN RING", 
                Platform = "STEAM",
                CoverUrl = "https://media.rawg.io/media/games/b29/b294fdd866dcdb643e7bab370a552855.jpg"
            },
            new DemoGame 
            { 
                Icon = "🔫", 
                Title = "RED DEAD REDEMPTION 2", 
                Platform = "ROCKSTAR",
                CoverUrl = "https://media.rawg.io/media/games/511/5118aff5091cb3efec399c808f8c598f.jpg"
            },
            new DemoGame 
            { 
                Icon = "👾", 
                Title = "HADES", 
                Platform = "EPIC",
                CoverUrl = "https://media.rawg.io/media/games/1f4/1f47a270b8f241e4676b14d39ec620f7.jpg"
            },
            new DemoGame 
            { 
                Icon = "🎯", 
                Title = "BALDUR'S GATE 3", 
                Platform = "STEAM",
                CoverUrl = "https://media.rawg.io/media/games/699/69907ecf13f172e9e144069769c3be73.jpg"
            },
            new DemoGame 
            { 
                Icon = "🌍", 
                Title = "HOLLOW KNIGHT: SILKSONG", 
                Platform = "GOG",
                CoverUrl = "https://media.rawg.io/media/games/27c/27cd8b7dead05a870f8a514a9a1915ad.jpg"
            },
            new DemoGame 
            { 
                Icon = "🏎️", 
                Title = "CONTROL", 
                Platform = "EPIC",
                CoverUrl = "https://media.rawg.io/media/games/253/2534a46f3da7fa7c315f1387515ca393.jpg"
            },
            new DemoGame 
            { 
                Icon = "🎮", 
                Title = "GOD OF WAR: RAGNARÖK", 
                Platform = "STEAM",
                CoverUrl = "https://media.rawg.io/media/games/1c3/1c305096502c475c00276c827f0fd697.jpg"
            },
            new DemoGame 
            { 
                Icon = "⚔️", 
                Title = "SEKIRO", 
                Platform = "STEAM",
                CoverUrl = "https://media.rawg.io/media/games/67f/67f62d1f062a6164f57575e0604ee9f6.jpg"
            },
            new DemoGame 
            { 
                Icon = "🔫", 
                Title = "DOOM ETERNAL", 
                Platform = "STEAM",
                CoverUrl = "https://media.rawg.io/media/games/3ea/3ea3c9bbd940b6cb7f2139e42d3d443f.jpg"
            },
            new DemoGame 
            { 
                Icon = "🎯", 
                Title = "STRAY", 
                Platform = "STEAM",
                CoverUrl = "https://media.rawg.io/media/games/cd3/cd3c9c7d3e95cb1608fd6250f1b90b7a.jpg"
            }
        };

        // Start counter animation
        animationTimer = new Timer(_ =>
        {
            InvokeAsync(() =>
            {
                if (animatedGameCount < 247)
                    animatedGameCount += 7;
                if (animatedPlatforms < 6)
                    animatedPlatforms++;
                if (animatedHours < 1234)
                    animatedHours += 43;
                
                StateHasChanged();
            });
        }, null, TimeSpan.FromMilliseconds(50), TimeSpan.FromMilliseconds(50));

        // Start game carousel animation
        carouselTimer = new Timer(_ =>
        {
            InvokeAsync(() =>
            {
                demoGames[currentGameIndex].IsActive = false;
                currentGameIndex = (currentGameIndex + 1) % demoGames.Count;
                demoGames[currentGameIndex].IsActive = true;
                StateHasChanged();
            });
        }, null, TimeSpan.FromSeconds(1.5), TimeSpan.FromSeconds(1.5));
    }

    private void NavigateToSignUp()
    {
        Navigation.NavigateTo("/signup");
    }

    private void NavigateToSignIn()
    {
        Navigation.NavigateTo("/signin");
    }

    public void Dispose()
    {
        animationTimer?.Dispose();
        carouselTimer?.Dispose();
    }
}

